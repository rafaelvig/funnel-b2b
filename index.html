<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Funnel B2B</title>
  <link rel="stylesheet" href="css/styles.css">
</head>

<body>

<header class="app-header">
  <div class="banner">
    <img src="img/banner.png" alt="Funnel B2B" />
  </div>

  <div class="funnel-nav">
    <button class="funnel-tab" onclick="loadFunnel('ESTRATEGICO')">ESTRATÉGICO</button>
    <button class="funnel-tab" onclick="loadFunnel('TOFU')">TOFU</button>
    <button class="funnel-tab" onclick="loadFunnel('MOFU')">MOFU</button>
    <button class="funnel-tab" onclick="loadFunnel('BOFU')">BOFU</button>
  </div>
</header>

<div id="auth" class="auth-bar"></div>

<div id="content">

  <fieldset>
    <legend>P19. ¿Qué canales utiliza hoy?</legend>

    <label><input type="checkbox" name="P19[]" value="telefono"> Teléfono</label><br>
    <label><input type="checkbox" name="P19[]" value="whatsapp"> WhatsApp</label><br>
    <label><input type="checkbox" name="P19[]" value="email"> Email</label><br>
    <label><input type="checkbox" name="P19[]" value="web"> Portal web</label>
  </fieldset>

  <fieldset id="bloqueP20" style="display:none">
    <legend>P20. ¿Cuál usa más?</legend>
    <div id="opcionesP20"></div>
  </fieldset>

</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
  window.SUPABASE_URL = "https://vjwxkruczzjnkzfjgrba.supabase.co";
  window.SUPABASE_ANON_KEY = "TU_ANON_KEY";
</script>

<script defer src="js/core.js"></script>
<script defer src="js/tofu.js"></script>
<script defer src="js/estrategico.js"></script>

<script>
  window.addEventListener("DOMContentLoaded", async () => {
    await window.renderAuthBar?.();
    await window.ensureStoreLoaded?.();
    window.loadFunnel?.("ESTRATEGICO");
  });
</script>

<script>
  const checkboxes = document.querySelectorAll('input[name="P19[]"]');
  const bloqueP20 = document.getElementById("bloqueP20");
  const opcionesP20 = document.getElementById("opcionesP20");

  function actualizarP20() {
    const seleccionados = [...checkboxes].filter(c => c.checked);
    opcionesP20.innerHTML = "";

    if (seleccionados.length === 0) {
      bloqueP20.style.display = "none";
      return;
    }

    bloqueP20.style.display = "";

    seleccionados.forEach(c => {
      const texto = c.parentElement.textContent.trim();

      opcionesP20.insertAdjacentHTML("beforeend",
        `<label>
           <input type="radio" name="P20" value="${c.value}">
           ${texto}
         </label><br>`
      );
    });
  }

  checkboxes.forEach(c => c.addEventListener("change", actualizarP20));
</script>

<footer class="app-footer">
  © 2026 Rafael Viglierchio. Uso interno.
</footer>

</body>
</html>
